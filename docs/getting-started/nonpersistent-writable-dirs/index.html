<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta content='width=device-width, initial-scale=1.0' name='viewport'>
    <!-- favicon -->
    <link href='/images/favicon.ico' rel='icon' type='image/png'>
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <!-- Use title if it's in the page YAML frontmatter -->
    <title>
      Nonpersistent Writable Directories - Nanobox Documentation
    </title>
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href="/stylesheets/all-46aa5565.css" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all-2eb6cf05.js" type="text/javascript"></script>
  </head>
  <body>
    <div id='header'>
      <a class='left' href='/' id='logo'>
        <svg enable-background='new 0 0 19 33' id='nanobox-logo' space='preserve' version='1.1' viewbox='0 0 19 33' x='0px' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg' y='0px'>
          <g>
            <g>
              <polygon fill='#405C70' points='19,26 9.6,30.9 0,26 9.4,21.1'></polygon>
              <polygon fill='#2F4352' points='15,24 9.5,26.9 3.9,24 9.4,21.1'></polygon>
              <polygon fill='#1C2830' points='9.6,30.9 19,26.1 19,27.4 9.6,32.3 '></polygon>
              <polygon fill='#19242B' points='9.6,30.9 0,26 0,27.3 9.6,32.3 '></polygon>
            </g>
            <g>
              <polygon fill='#1E77A3' points='9.5,23.1 17.2,19.1 17.2,20.3 9.5,24.2 '></polygon>
              <polygon fill='#175D80' points='9.5,23.1 1.8,19.1 1.8,20.3 9.5,24.2 '></polygon>
              <polygon fill='#62B1DD' points='17.2,19.1 9.5,23.1 1.8,19.1 9.5,15.2'></polygon>
              <polygon enable-background='new' fill='#0B194F' opacity='0.42' points='15.1,18.1 9.5,21 3.9,18.1 9.5,15.2 '></polygon>
            </g>
            <g>
              <polygon fill='#43C494' points='9.5,16.9 18.8,12.2 18.8,13.5 9.5,18.3 '></polygon>
              <polygon fill='#4AAA88' points='9.5,16.9 0.2,12.2 0.2,13.5 9.5,18.3 '></polygon>
              <polygon fill='#7FE0BF' points='18.8,12.2 9.5,16.9 0.2,12.2 9.5,7.4 '></polygon>
              <polygon enable-background='new' fill='#43C4A6' opacity='0.76' points='16.3,10.9 9.5,14.4 2.7,10.9 9.5,7.4'></polygon>
            </g>
            <g>
              <polygon fill='#FDE5A6' points='18.8,4.8 9.5,9.6 0.2,4.8 9.5,0'></polygon>
              <polygon fill='#E9D399' points='9.5,9.6 18.8,4.8 18.8,6.2 9.5,11'></polygon>
              <polygon fill='#D9BB6F' points='9.5,9.6 0.2,4.8 0.2,6.2 9.5,11'></polygon>
            </g>
          </g>
        </svg>
        <span id='nb-title'>
          <span class='drop'>Nanobox</span>
          Docs
        </span>
      </a>
      <ul class='links'>
        <li class='text'>
          <a class='active' href='/'>
            Local
          </a>
        </li>
        <li class='text'>
          <a href='/production/intro/'>
            Production
          </a>
        </li>
        <li>
          <a href='http://nanobox.io'>
            <svg enable-background='new 0 0 18 18' id='home-icon' space='preserve' version='1.1' viewbox='0 0 18 18' x='0px' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg' y='0px'>
              <polygon fill='none' points='11,13 11,9 9,7 7,9 &#x000A;	7,13 ' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2'></polygon>
              <polyline fill='none' points='14,11 14,16 4,16 &#x000A;	4,11 ' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2'></polyline>
              <polyline fill='none' points='2,9.1 9.1,2 &#x000A;	16.1,9.1 ' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2'></polyline>
            </svg>
          </a>
        </li>
      </ul>
    </div>
    <div id='wrapper'>
      <div class='open' id='contents-btn'>Contents</div>
      <div id='navigation'>
        <ul class='closed' id='contents'>
          <li>
            <a href="/">Overview</a>
          </li>
          <li>
            <a href="/why-nanobox/">Why Nanobox?</a>
          </li>
          <li>
            <a href="/installation/installing-nanobox/">Installation</a>
            <ul class='sub'>
              <li>
                <a href="/installation/upgrading/">Upgrading</a>
              </li>
              <li>
                <a href="/installation/uninstalling/">Uninstalling</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/getting-started/intro/">Getting Started</a>
            <ul class='sub'>
              <li>
                <a href="/getting-started/project-setup/">Project Setup</a>
              </li>
              <li>
                <a href="/getting-started/nanofile/">.nanofile</a>
              </li>
              <li>
                <a href="/getting-started/boxfile/">Boxfile</a>
              </li>
              <li>
                <a href="/getting-started/engines/">Engines</a>
              </li>
              <li>
                <a href="/getting-started/services/">Services</a>
              </li>
              <li>
                <a href="/getting-started/logs/">Logs</a>
              </li>
              <li>
                <a href="/getting-started/deploys/">Deploys</a>
              </li>
              <li>
                <a href="/getting-started/tunneling/">Tunneling</a>
              </li>
              <li>
                <a href="/getting-started/network-storage/">Network Storage</a>
              </li>
              <li class='active'>
                <a href="/getting-started/nonpersistent-writable-dirs/">Nonpersistent Writable Directories</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/cli/intro/">Command Line Interface</a>
            <ul class='sub'>
              <li>
                <a href="/cli/bootstrap/">bootstrap</a>
              </li>
              <li>
                <a href="/cli/build/">build</a>
              </li>
              <li>
                <a href="/cli/console/">console</a>
              </li>
              <li>
                <a href="/cli/create/">create</a>
              </li>
              <li>
                <a href="/cli/deploy/">deploy</a>
              </li>
              <li>
                <a href="/cli/destroy/">destroy</a>
              </li>
              <li>
                <a href="/cli/exec/">exec</a>
              </li>
              <li>
                <a href="/cli/fetch/">fetch</a>
              </li>
              <li>
                <a href="/cli/halt/">halt</a>
              </li>
              <li>
                <a href="/cli/help/">help</a>
              </li>
              <li>
                <a href="/cli/init/">init</a>
              </li>
              <li>
                <a href="/cli/log/">log</a>
              </li>
              <li>
                <a href="/cli/new/">new</a>
              </li>
              <li>
                <a href="/cli/publish/">publish</a>
              </li>
              <li>
                <a href="/cli/reload/">reload</a>
              </li>
              <li>
                <a href="/cli/resume/">resume</a>
              </li>
              <li>
                <a href="/cli/status/">status</a>
              </li>
              <li>
                <a href="/cli/suspend/">suspend</a>
              </li>
              <li>
                <a href="/cli/tunnel/">tunnel</a>
              </li>
              <li>
                <a href="/cli/up/">up</a>
              </li>
              <li>
                <a href="/cli/update/">update</a>
              </li>
              <li>
                <a href="/cli/upgrade/">upgrade</a>
              </li>
              <li>
                <a href="/cli/watch/">watch</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/boxfile/intro/">Boxfile</a>
            <ul class='sub'>
              <li>
                <a href="/boxfile/env/">env</a>
              </li>
              <li>
                <a href="/boxfile/build/">build</a>
              </li>
              <li>
                <a href="/boxfile/code-services/">Code Services</a>
              </li>
              <li>
                <a href="/boxfile/data-services/">Data Services</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/engines/intro/">Engines</a>
            <ul class='sub'>
              <li>
                <a href="/engines/how-engines-work/">How Engines Work</a>
              </li>
              <li>
                <a href="/engines/boxfile-spec/">Generating a Boxfile</a>
              </li>
              <li>
                <a href="/engines/project-creation/">Project Creation</a>
              </li>
              <li>
                <a href="/engines/enginefile/">Enginefile</a>
              </li>
              <li>
                <a href="/engines/style-guide/">Style Guide</a>
              </li>
              <li>
                <a href="/engines/scripts/intro/">Scripts</a>
                <ul class='sub'>
                  <li>
                    <a href="/engines/scripts/sniff/">sniff</a>
                  </li>
                  <li>
                    <a href="/engines/scripts/boxfile/">boxfile</a>
                  </li>
                  <li>
                    <a href="/engines/scripts/prepare/">prepare</a>
                  </li>
                  <li>
                    <a href="/engines/scripts/build/">build</a>
                  </li>
                  <li>
                    <a href="/engines/scripts/cleanup/">cleanup</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="/engines/common-tasks/intro/">Common Tasks</a>
                <ul class='sub'>
                  <li>
                    <a href="/engines/common-tasks/installing-binaries/">Installing Binaries</a>
                  </li>
                  <li>
                    <a href="/engines/common-tasks/generating-output/">Generating Output</a>
                  </li>
                  <li>
                    <a href="/engines/common-tasks/working-with-input/">Working with Input</a>
                  </li>
                  <li>
                    <a href="/engines/common-tasks/validation/">Validation</a>
                  </li>
                  <li>
                    <a href="/engines/common-tasks/caching/">Caching</a>
                  </li>
                  <li>
                    <a href="/engines/common-tasks/environment-variables/">Environment Variables</a>
                  </li>
                  <li>
                    <a href="/engines/common-tasks/template-generation/">Template Generation</a>
                  </li>
                  <li>
                    <a href="/engines/common-tasks/application-config/">Application Configuration</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="/engines/publish/">Publish</a>
              </li>
              <li>
                <a href="/engines/dev-workflow/">Development Workflow</a>
              </li>
              <li>
                <a href="/engines/debugging/">Debugging</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="/other/intro/">Other</a>
          </li>
        </ul>
      </div>
      <div id='content'>
        <h1>Nonpersistent Writable Directories</h1>
        <p>Code services created through nanobox are read-only, but in some cases, it may be necessary to enable writable permissions in a directory without storing that directory in <a href="/getting-started/network-storage/">network storage</a>. Nonpersistent writable directories allow you to enable writable permissions on directories in your code instances’ local filesystems. This doc explains how nonpersistent writable directories work and how they’re different from network directories.</p>
        
        <h3 id="what-is-a-nonpersistent-writable-directory">What is a Nonpersistent Writable Directory</h3>
        
        <p>A nonpersistent writable directory is a directory stored in your instances’ local filesystem with writable permissions. Because they are stored locally in each instance, their contents do not persist when the instance is decommissioned.</p>
        
        <h3 id="how-are-they-different-than-network-directories">How Are They Different Than Network Directories?</h3>
        
        <p>Nonpersistent writable directories and Network Directories are very similar, but have two key differences.</p>
        
        <ul>
        <li><p>Nonpersistent writable directories are stored in your instances’ local filesystems and are unique to each instance. Network directories are stored in a network storage service and shared between all instances.</p></li>
        <li><p>The contents of nonpersistent writable directories are flushed on each deploy. The contents of network directories persist between deploys.</p></li>
        </ul>
        
        <h2 id="configuring-nonpersistent-writable-directories">Configuring Nonpersistent Writable Directories</h2>
        
        <p>Nonpersistent writable directories are available to code services (webs &amp; workers) and are configured in your Boxfile. On deploy, these directories are replaced with empty, writable directories. Filepaths should be relative to the root of your repo.</p>
        
        <h4 id="nonpersistent_writable_dirs">nonpersistent_writable_dirs</h4>
        <pre class="highlight yaml"><code><span class="s">web1</span><span class="pi">:</span>&#x000A;  <span class="s">nonpersistent_writable_dirs</span><span class="pi">:</span>&#x000A;    <span class="pi">-</span> <span class="s">path/to/dirA</span>&#x000A;    <span class="pi">-</span> <span class="s">path/to/dirB</span>&#x000A;</code></pre>
        
        <h4 id="nested-directories-will-be-ignored">Nested Directories Will Be Ignored</h4>
        
        <p>When specifying <code>nonpersistent_writable_dirs</code> in your Boxfile, you shouldn’t list “nested” directories. For example: dirA and dirA/nested-dir. While the writable permissions are recursive, only the parent directory will be honored and the nested subdirectories will not be created.</p>
        
        <h4 id="nonpersistent-writable-dirs-can-39-t-be-inside-of-network-dirs">Nonpersistent Writable Dirs Can&#39;t be Inside of Network Dirs</h4>
        
        <p>When defining <code>nonpersistent_writable_dirs</code>, be sure the directory you define is not inside of a <code>network_dir</code>. All network directories are stored in a storage service and files within them cannot be saved to the local filesystem of instances.</p>
        
        <h2 id="things-to-know">Things To Know</h2>
        
        <h3 id="do-not-persist-between-deploys">Do Not Persist Between Deploys</h3>
        
        <p>As the name suggests, nonpersistent writable directories do not persist between deploys. These directories are in each instances’ local filesystem and are decommissioned with the instance. They should only be used for transient data such as cache, temporary files, etc.</p>
        
        <h3 id="faster-than-network-directories">Faster than Network Directories</h3>
        
        <p>Because nonpersistent network directories are a part of each instance’s local filesystem, they are much faster than network directories. Network directories are housed in an external service and accessed across the network, adding inherent latency.</p>
        
        <h3 id="overwrites-the-directory-in-your-repo">Overwrites the Directory in Your Repo</h3>
        
        <p>Nonpersistent writable directories will not inherit code from your repo. These directories are replaced with empty, writable directories on deploy, overwriting any files inside of them.</p>
        
        <h3 id="limited-to-service’s-local-disk-size">Limited to Service’s Local Disk Size</h3>
        
        <p>The amount of code/data that can be stored in nonpersistent network directories is limited to the disk size of your code service – 4GB on public/private cloud instances and variable on bare metal instances.</p>
        
        <h2 id="recommended-uses">Recommended Uses</h2>
        
        <h3 id="static-asset-caching">Static Asset Caching</h3>
        
        <p>Nonpersistent writable directories are a great solution for caching static assets. The files are local, so reads and writes are fast. Caches are built organically as requests hit each instance. Also, there’s no chance of multiple instances trying to write to the same cache file and interrupting network storage connections.</p>
        
        <h4 id="priming-caches-on-deploy">Priming Caches on Deploy</h4>
        
        <p>If using a <code>before_deploy</code> or <code>after_deploy</code> hook to prime your cache on deploy, these commands will only run on one of your service’s instances. In services with more than one instance, you should use <code>before_deploy_all</code> and <code>after_deploy_all</code> hooks to run the command on all instances.</p>
        <div id='pagination'>
          <a class="prev" href="/getting-started/network-storage/">Network Storage</a>
          <a class="next" href="/cli/intro/">Command Line Interface</a>
        </div>
      </div>
    </div>
    <div id='footer'></div>
  </body>
</html>
